#!/usr/bin/env bash
SCRIPT_PATH="$(readlink -f "${BASH_SOURCE[0]}")"
SCRIPT_DIR="$(cd "$(dirname "$SCRIPT_PATH")" && pwd)"
export HOOK_NAME="pre-push"
source "${SCRIPT_DIR}/hook-helpers.sh"

# Pre-push 훅:
# - 단위 테스트
# - (E2E는 GitHub PR 파이프라인에서만 수행)

set -euo pipefail

cd "$(git rev-parse --show-toplevel)"

info "pytest unit 실행 중..."
if ! uv run pytest tests/unit/ -q; then
    fail "단위 테스트 실패. push 전 문제를 수정하세요."
fi

info "모든 테스트 통과. push 진행 가능합니다."
